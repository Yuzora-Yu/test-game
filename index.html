<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>オーイシガチャ -SSA単独記念ピックアップ-</title>
<link rel="preconnect" href="https://unpkg.com">
<style>
  :root{
    --w: min(1120px, 96vw);
    --bg: radial-gradient(1200px 600px at 50% -100px, #151a27 0%, #0b0f1b 45%, #070915 100%);
    --panel: rgba(255,255,255,.06);
    --border: rgba(255,255,255,.10);
  }
  html,body{height:100%}
  body{
    margin:0; color:#fff;
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI",
      "Hiragino Sans","Noto Sans JP","Yu Gothic UI", Roboto, sans-serif;
    background: var(--bg);
  }
  header, main, footer { width: var(--w); margin: 18px auto; }
  header h1{ margin: 8px 0 4px; font-size: clamp(22px,3.6vw,28px); letter-spacing:.02em; }
  header p { margin: 0; color:#b9c4d4; }

  .toolbar{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
  .btn{
    padding:10px 14px; border:1px solid rgba(255,255,255,.25);
    background: var(--panel); color:#fff; border-radius:8px; cursor:pointer;
    backdrop-filter: blur(4px);
  }
  .btn.primary{ background: linear-gradient(135deg,#ff357a,#ff8a00); border-color: transparent; }
  .btn:disabled{ opacity:.5; cursor:not-allowed; }

  /* ステージ（1枚ずつの表示） */
  #stage{
    position:relative; height: 340px; border-radius:14px; overflow:hidden;
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    box-shadow: 0 12px 40px rgba(0,0,0,.35) inset, 0 8px 26px rgba(0,0,0,.24);
    display:grid; place-items:center;
  }
  #stage .hint{ position:absolute; bottom:10px; left:0; right:0; text-align:center; color:#c7d2e4; opacity:.8; font-size:12px; }
  #btnSkipAll{ position:absolute; top:10px; right:10px; z-index:5; display:none; font-size:12px; }

  /* UR演出（単発/すべてめくる用） */
  .beam{ position:absolute; inset:-20% 35% -40% 35%; opacity:0; pointer-events:none;
         background: linear-gradient(180deg, rgba(255,255,255,.0) 0%, rgba(255,255,255,.85) 40%, rgba(255,255,255,.0) 100%),
                     repeating-linear-gradient( to bottom,
                       rgba(255,0,120,.35),rgba(255,0,120,.35) 8px,
                       rgba(255,170,0,.35) 8px, rgba(255,170,0,.35) 16px,
                       rgba(0,220,255,.35) 16px, rgba(0,220,255,.35) 24px,
                       rgba(0,230,174,.35) 24px, rgba(0,230,174,.35) 32px);
         filter: blur(2px); mix-blend-mode: screen; transform: scaleY(0.3); }
  .beam.show{ animation: beamRise .8s ease-out forwards; }
  @keyframes beamRise{ 0%{opacity:0; transform:scaleY(0.3)} 60%{opacity:1} 100%{opacity:1; transform:scaleY(1)} }

  .rays{ position:absolute; inset:-20% -20%; opacity:0; pointer-events:none;
         background: conic-gradient(from 0deg,
           rgba(255,216,112,.0) 0deg, rgba(255,216,112,.7) 6deg, rgba(255,216,112,.0) 12deg,
           rgba(0,227,174,.0) 12deg, rgba(0,227,174,.7) 18deg, rgba(0,227,174,.0) 24deg,
           rgba(0,212,255,.0) 24deg, rgba(0,212,255,.7) 30deg, rgba(0,212,255,.0) 36deg);
         mix-blend-mode: screen; filter: blur(1px); }
  .rays.show{ animation: raysSpin 1.6s linear infinite, raysFade .25s ease-out forwards; }
  @keyframes raysSpin{ to{ transform: rotate(360deg); } }
  @keyframes raysFade{ from{opacity:0} to{opacity:.9} }

  /* カード（3Dめくり） */
  .card{ width:min(280px,70vw); height:min(180px,45vw); perspective: 1000px; }
  .card .inner{ position:relative; width:100%; height:100%; transform-style:preserve-3d; transition: transform 700ms cubic-bezier(.2,.8,.2,1); }
  .card.open .inner{ transform: rotateY(180deg); }
  .face{ position:absolute; inset:0; border-radius:16px; backface-visibility:hidden; overflow:hidden; border:1px solid var(--border); }
  .back{ display:grid; place-items:center; background: linear-gradient(135deg,#1a2030,#0e1422); }
  .back::after{ content:"★ TAP"; font-weight:700; letter-spacing:.08em; color:#9fb1ff; }
  .front{ transform: rotateY(180deg); background:#0b0f1b; display:grid; grid-template-rows:1fr auto; }
  .art{ display:grid; place-items:center; }
  .icon{ font-size:42px; }
  .name{ position:relative; text-align:center; font-size:12px; color:#d5dfef; padding:8px; border-top:1px solid rgba(255,255,255,.08); background:rgba(255,255,255,.03); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  /* ▼名前の自動マルキー用 */
  .name.marquee{ overflow:hidden; }
  .name .track{ display:inline-block; will-change: transform; }
  .name .scroll{ display:inline-block; padding-right:28px; }
  @keyframes scrollX{ from{ transform:translateX(0);} to{ transform:translateX(-50%);} }
  .name.marquee .track{ animation: scrollX 9s linear infinite; }
  .name.marquee:hover .track{ animation-play-state: paused; }
  @media (prefers-reduced-motion: reduce){
    .name.marquee .track{ animation:none; }
  }

  /* レア度グロー（表面） */
  .glow{ position:absolute; inset:-2px; border-radius:16px; pointer-events:none; mix-blend-mode:screen; opacity:.85; }
  .R  .glow{ background: radial-gradient(80% 60% at 50% -10%, rgba(86,204,242,.30), transparent 60%); }
  .SR .glow{ background: radial-gradient(80% 60% at 50% -10%, rgba(193,168,255,.38), transparent 60%); }
  .SSR.glowPulse, .UR.glowPulse { animation: glow 1.8s ease-in-out infinite; }
  .SSR .glow{ background: radial-gradient(80% 60% at 50% -10%, rgba(255,216,112,.45), transparent 60%); }
  .UR  .glow{ background: radial-gradient(80% 60% at 50% -10%, rgba(0,227,174,.55), transparent 60%); }
  @keyframes glow{ 0%,100%{opacity:.7} 50%{opacity:1} }

  /* 特殊演出（表にする前） */
  .flash{ position:absolute; inset:0; background: radial-gradient(circle at 50% 50%, rgba(255,255,255,.95), transparent 60%); opacity:0; pointer-events:none; }
  .flash.show{ animation: flash .22s ease forwards; }
  @keyframes flash{ from{opacity:0} to{opacity:1} }
  #shakeHost.shake{ animation:shake .6s cubic-bezier(.36,.07,.19,.97) both }
  @keyframes shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(2px,0,0)}30%,50%,70%{transform:translate3d(-4px,0,0)}40%,60%{transform:translate3d(4px,0,0)}}

  /* 最終結果カード（保存対象） */
  #resultCard{ margin-top:16px; background: var(--panel); border:1px solid var(--border);
